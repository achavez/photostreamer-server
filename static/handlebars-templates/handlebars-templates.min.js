Handlebars.registerHelper("date",function(a,b){var a=moment(a),c='<time datetime="'+a.toISOString()+'">'+a.format(b)+"</time>";return new Handlebars.SafeString(c)}),Handlebars.registerHelper("fsize",function(a){return new Handlebars.SafeString(filesize(a))}),Handlebars.registerHelper("exif",function(a){var b={};_.each(a,function(a,c){if(a){var d=c.split(" ")[0],e=c.split(" ")[1];"undefined"==typeof b[d]&&(b[d]=[]),b[d].push([e,a])}}),_.each(b,function(a){a.sort()});var c='<div class="panel-group" id="exif-accordion">';return _.each(b,function(a,b){c+='<div class="panel panel-default">',c+='<div class="panel-heading"><a data-toggle="collapse" data-parent="#exif-accordion" href="#collapse-'+b+'"><h4 class="panel-title">'+b+"</a></h4></div>",c+='<div id="collapse-'+b+'" class="panel-collapse collapse"><div class="panel-body">',c+='<ul class="list-unstyled">',_.each(a,function(a){c+="<li><strong>"+a[0]+"</strong> "+a[1]+"</li>"}),c+="</ul>",c+="</div></div>",c+="</div>"}),c+="</div>",new Handlebars.SafeString(c)}),this.Templates=this.Templates||{},this.Templates.download=Handlebars.template(function(a,b,c,d,e){function f(){return'<i class="glyphicon glyphicon-ok text-success"></i>'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k=this,l="function",m=this.escapeExpression,n=c.helperMissing;return j+="<tr>\n	<td>",g=c["if"].call(b,b&&b.downloaded,{hash:{},inverse:k.noop,fn:k.program(1,f,e),data:e}),(g||0===g)&&(j+=g),j+="</td>\n	<td>",(h=c.fileid)?g=h.call(b,{hash:{},data:e}):(h=b&&b.fileid,g=typeof h===l?h.call(b,{hash:{},data:e}):h),j+=m(g)+"</td>\n	<td>"+m((h=c.fsize||b&&b.fsize,i={hash:{},data:e},h?h.call(b,b&&b.filesize,i):n.call(b,"fsize",b&&b.filesize,i)))+'</td>\n	<td>\n		<a href="/download/',(h=c._id)?g=h.call(b,{hash:{},data:e}):(h=b&&b._id,g=typeof h===l?h.call(b,{hash:{},data:e}):h),j+=m(g)+'">\n			<button type="button" class="btn btn-primary btn-xs"><i class="glyphicon glyphicon-download-alt"></i></button>\n		</a>\n	</td>\n</tr>'}),this.Templates.inspector=Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n		<strong>Full file URL</strong> <a href="',(e=c.full)?d=e.call(a,{hash:{},data:b}):(e=a&&a.full,d=typeof e===q?e.call(a,{hash:{},data:b}):e),f+=r(d)+'" target="_blank">',(e=c.full)?d=e.call(a,{hash:{},data:b}):(e=a&&a.full,d=typeof e===q?e.call(a,{hash:{},data:b}):e),f+=r(d)+"</a></br>\n	"}function g(a,b){var d,e,f,g="";return g+="\n		<h3>Metadata</h3>\n		",e=c.exif||a&&a.exif,f={hash:{},inverse:s.noop,fn:s.program(4,h,b),data:b},d=e?e.call(a,a&&a.exif,f):t.call(a,"exif",a&&a.exif,f),(d||0===d)&&(g+=d),g+="\n	"}function h(){var a="";return a}function i(){return'\n	<button type="button" class="btn btn-primary request-full"><i class="glyphicon glyphicon-import"></i> Request file</button>\n'}function j(a,b){var d,e,f="";return f+='\n	<a href="/download/',(e=c._id)?d=e.call(a,{hash:{},data:b}):(e=a&&a._id,d=typeof e===q?e.call(a,{hash:{},data:b}):e),f+=r(d)+'">\n		',d=c["if"].call(a,a&&a.downloaded,{hash:{},inverse:s.program(11,l,b),fn:s.program(9,k,b),data:b}),(d||0===d)&&(f+=d),f+="\n	</a>\n"}function k(){return'\n			<button type="button" class="btn btn-primary download"><i class="glyphicon glyphicon-saved"></i> Redownload</button>\n		'}function l(){return'\n			<button type="button" class="btn btn-primary download"><i class="glyphicon glyphicon-download-alt"></i> Download</button>\n		'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var m,n,o,p="",q="function",r=this.escapeExpression,s=this,t=c.helperMissing;return p+='<p>\n	<img class="img-responsive" src="',(n=c.thumbnail)?m=n.call(b,{hash:{},data:e}):(n=b&&b.thumbnail,m=typeof n===q?n.call(b,{hash:{},data:e}):n),p+=r(m)+'" />\n</p>\n<p>\n	<strong>File ID</strong> ',(n=c.fileid)?m=n.call(b,{hash:{},data:e}):(n=b&&b.fileid,m=typeof n===q?n.call(b,{hash:{},data:e}):n),p+=r(m)+'</br>\n	<strong>Thumbnail URL</strong> <a href="',(n=c.thumbnail)?m=n.call(b,{hash:{},data:e}):(n=b&&b.thumbnail,m=typeof n===q?n.call(b,{hash:{},data:e}):n),p+=r(m)+'" target="_blank">',(n=c.thumbnail)?m=n.call(b,{hash:{},data:e}):(n=b&&b.thumbnail,m=typeof n===q?n.call(b,{hash:{},data:e}):n),p+=r(m)+"</a></br>\n	",m=c["if"].call(b,b&&b.full,{hash:{},inverse:s.noop,fn:s.program(1,f,e),data:e}),(m||0===m)&&(p+=m),p+="\n	<strong>Time created</strong> "+r((n=c.date||b&&b.date,o={hash:{},data:e},n?n.call(b,b&&b.created,"h:mma",o):t.call(b,"date",b&&b.created,"h:mma",o)))+"</br>\n	<strong>Date created</strong> "+r((n=c.date||b&&b.date,o={hash:{},data:e},n?n.call(b,b&&b.created,"MMMM D, YYYY",o):t.call(b,"date",b&&b.created,"MMMM D, YYYY",o)))+"</br>\n	<strong>Filesize</strong> "+r((n=c.fsize||b&&b.fsize,o={hash:{},data:e},n?n.call(b,b&&b.filesize,o):t.call(b,"fsize",b&&b.filesize,o)))+"</br>\n	<strong>Size</strong> "+r((m=b&&b.dimensions,m=null==m||m===!1?m:m.width,typeof m===q?m.apply(b):m))+"px x "+r((m=b&&b.dimensions,m=null==m||m===!1?m:m.height,typeof m===q?m.apply(b):m))+"px\n	",m=c["if"].call(b,b&&b.exif,{hash:{},inverse:s.noop,fn:s.program(3,g,e),data:e}),(m||0===m)&&(p+=m),p+="\n</p>\n",m=c.unless.call(b,b&&b.requested,{hash:{},inverse:s.noop,fn:s.program(6,i,e),data:e}),(m||0===m)&&(p+=m),p+="\n",m=c["if"].call(b,b&&b.full,{hash:{},inverse:s.noop,fn:s.program(8,j,e),data:e}),(m||0===m)&&(p+=m),p}),this.Templates.photo=Handlebars.template(function(a,b,c,d,e){function f(){return'\n				<button type="button" class="btn btn-default request-full"><i class="glyphicon glyphicon-import"></i> Request</button>\n			'}function g(a,b){var d,e,f="";return f+='\n				<a href="/download/',(e=c._id)?d=e.call(a,{hash:{},data:b}):(e=a&&a._id,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+'">\n					',d=c["if"].call(a,a&&a.downloaded,{hash:{},inverse:p.program(6,i,b),fn:p.program(4,h,b),data:b}),(d||0===d)&&(f+=d),f+="\n				</a>\n			"}function h(){return'\n						<button type="button" class="btn btn-default btn-xs"><i class="glyphicon glyphicon-saved"></i> Redownload</button>\n					'}function i(){return'\n						<button type="button" class="btn btn-default btn-xs"><i class="glyphicon glyphicon-download-alt"></i> Download</button>\n					'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var j,k,l,m="",n="function",o=this.escapeExpression,p=this,q=c.helperMissing;return m+='<div class="panel panel-default">\n	<div class="panel-body">\n		<p>\n			<img class="img-responsive" src="',(k=c.thumbnail)?j=k.call(b,{hash:{},data:e}):(k=b&&b.thumbnail,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'" />\n		</p>\n		<p>\n			<small><strong>Created</strong> '+o((k=c.date||b&&b.date,l={hash:{},data:e},k?k.call(b,b&&b.created,"h:mm:ssa M/D/YY",l):q.call(b,"date",b&&b.created,"h:mm:ssa M/D/YY",l)))+"</small></br>\n			<small><strong>Filesize</strong> "+o((k=c.fsize||b&&b.fsize,l={hash:{},data:e},k?k.call(b,b&&b.filesize,l):q.call(b,"fsize",b&&b.filesize,l)))+"</small></br>\n			<small><strong>Size</strong> "+o((j=b&&b.dimensions,j=null==j||j===!1?j:j.width,typeof j===n?j.apply(b):j))+"px x "+o((j=b&&b.dimensions,j=null==j||j===!1?j:j.height,typeof j===n?j.apply(b):j))+'px</small>\n		</p>\n		<div class="btn-group btn-group-xs">\n			',j=c.unless.call(b,b&&b.requested,{hash:{},inverse:p.noop,fn:p.program(1,f,e),data:e}),(j||0===j)&&(m+=j),m+="\n			",j=c["if"].call(b,b&&b.full,{hash:{},inverse:p.noop,fn:p.program(3,g,e),data:e}),(j||0===j)&&(m+=j),m+='\n			<button type="button" class="inspect btn btn-default"><i class="glyphicon glyphicon-zoom-in"></i> Inspect</button>\n		</div>\n	</div>\n</div>'});